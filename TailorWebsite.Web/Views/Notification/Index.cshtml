@model IEnumerable<TailorWebsite.ViewModels.VM.NotificationViewModel>
@{
    ViewData["Title"] = "Powiadomienia";
}

@* Sekcja Nagłówkowa *@
<section class="position-relative overflow-hidden rounded-4 text-white dark-blue mb-4 shadow p-4">
    <div class="row align-items-center position-relative" style="z-index: 1;">
        <div class="col-lg-8">
            <h5 class="text-warning text-uppercase letter-spacing-2 mb-2">Centrum Informacji</h5>
            <h1 class="display-6 fw-bold mb-2">Powiadomienia</h1>
            <p class="text-white-50 mb-0">Bądź na bieżąco ze statusami zamówień i wiadomościami z pracowni.</p>
        </div>
        <div class="col-lg-4 text-end d-none d-lg-block">
            <i class="bi bi-bell-fill text-warning" style="font-size: 5rem; opacity: 0.5;"></i>
        </div>
    </div>
</section>

@* Przycisk powrotu *@
<div class="mb-4">
    <a asp-controller="Profile" asp-action="Index" class="btn btn-link text-decoration-none text-muted ps-0">
        <i class="bi bi-arrow-left me-1"></i> Powrót do profilu
    </a>
</div>

@* Lista Powiadomień *@
<div class="row justify-content-center">
    <div class="col-lg-10">
        
        @if (Model != null && Model.Any())
        {
            <div class="d-flex flex-column gap-3">
                @foreach (var notification in Model.OrderByDescending(n => n.CreatedAt))
                {
                    // Logika stylów dla przeczytanych/nieprzeczytanych
                    var isRead = notification.IsRead;
                    var cardClass = isRead ? "bg-light border-0 opacity-75" : "bg-white border-0 shadow-sm border-start border-4 border-warning";
                    var iconClass = isRead ? "bi-check2-circle text-muted" : "bi-bell-fill text-warning";
                    var textClass = isRead ? "text-muted" : "text-dark fw-semibold";
                    
                    <div class="card @cardClass notification-card rounded-3 overflow-hidden">
                        <div class="card-body p-4 d-flex align-items-center gap-3">
                            
                            @* Ikona *@
                            <div class="flex-shrink-0">
                                <div class="rounded-circle d-flex align-items-center justify-content-center @(isRead ? "bg-white" : "bg-gold-subtle")" style="width: 48px; height: 48px;">
                                    <i class="bi @iconClass fs-4"></i>
                                </div>
                            </div>

                            @* Treść *@
                            <div class="flex-grow-1">
                                <div class="d-flex justify-content-between align-items-start mb-1">
                                    <p class="mb-1 @textClass mb-0">@notification.Message</p>
                                    <small class="text-muted ms-2 text-nowrap" style="font-size: 0.75rem;">
                                        @notification.CreatedAt.ToString("dd.MM.yyyy")
                                    </small>
                                </div>
                                
                                @if (!isRead)
                                {
                                    <form asp-action="MarkAsRead" method="post" class="mt-2">
                                        <input type="hidden" name="id" value="@notification.Id" />
                                        <button type="submit" class="btn btn-link p-0 text-decoration-none text-warning small fw-bold">
                                            <i class="bi bi-check-lg me-1"></i>Oznacz jako przeczytane
                                        </button>
                                    </form>
                                }
                            </div>

                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            @* Empty State *@
            <div class="card border-0 shadow-sm text-center py-5 rounded-4">
                <div class="card-body">
                    <div class="bg-light rounded-circle p-4 d-inline-block mb-3">
                        <i class="bi bi-bell-slash text-muted" style="font-size: 3rem;"></i>
                    </div>
                    <h3 class="fw-bold">Brak powiadomień</h3>
                    <p class="text-muted mb-0">Wszystko jest aktualne. Poinformujemy Cię o zmianach w Twoich zamówieniach.</p>
                </div>
            </div>
        }
        
    </div>
</div>

